---
tags:
  - sql
  - db
  - clickhouse
links:
  - https://www.youtube.com/watch?v=PLMSA_gDdyM
  - https://www.youtube.com/watch?v=36Qql0DE4tk
  - https://clickhouse.com/docs/ru/getting-started/tutorial
  - https://www.youtube.com/live/Jp1SEm4UU48?si=2fDeYOjJEAVj0dGw
---
_ClickHouse_ - колонночная СУБД, спроектированная по принципу OLAP [[OLAP OLTP]]
Она спроектирована для **масштабируемой и высокопроизводительной аналитики в реальном времени** на больших объемах данных. 
### **Когда использовать ClickHouse?**
- **Web-аналитика**: Анализ пользовательского поведения, событий, кликов и посещений страниц.
- **Системы мониторинга**: Пример — обработка временных рядов (метрик серверов, логов, датчиков IoT).
- **Бизнес-аналитика**: Построение отчетов, KPI-метрик, трекинг конверсий.
- **Big Data**: Обработка огромных объемов данных с акцентом на скорость.

![[Pasted image 20241213205550.png]]

### **Ключевые характеристики ClickHouse**

- Данные хранятся в колонках, а не в строках, что значительно ускоряет чтение данных для аналитических запросов.
- Оптимизация за счет того, что считываются только необходимые колонки [[Гранула]]. 
- Идеально подходит для сложных аналитических вычислений, включая агрегацию, группировку, сортировку, фильтрацию и джойны.
> Джойны могут быть реализованы более эффективно при использовании _Словарей_ для харнения колонок.
- Возможность партицирования(до _1000_ партиций на одну таблицу) и сэмплирования данных (оценка на случайно выборке).
- Имеет мощный _SQL_-интерфейс.
- Использует различные алгоритмы _сжатия_ (например, LZ4, ZSTD), чтобы сократить объем хранимых данных.
- _Поддерживает распределенные кластеры_, позволяя обрабатывать огромные объемы данных на множестве серверов. _Горизонтальное масштабирование_.
-  хорошо подходит для _обработки временных рядов_ благодаря функциям агрегации, _индексам_ и оптимизированному хранению.

### **Киллер-фичи ClickHouse**
1. **Агрегации "на лету"**:  
    ClickHouse обрабатывает данные так, чтобы результаты агрегаций (суммирование, средние значения и т. д.) считались непосредственно во время выполнения запроса, что значительно ускоряет обработку.
2. **Массивы и сложные структуры данных**:
    - В отличие от многих других аналитических СУБД, ClickHouse поддерживает типы данных, такие как массивы и JSON, которые облегчают работу с полуструктурированными данными.
3. **MergeTree и семейство движков**:
    - Движок таблиц [[MergedTree движок]] позволяет автоматически объединять данные и эффективно индексировать их, что ускоряет выполнение запросов.
    - Поддерживает секционирование и сортировку.
4. **Материализованные представления**:
    - Возможность создавать материализованные представления (materialized views) для автоматического вычисления и сохранения результатов запросов, что особенно полезно для дашбордов.
5. **Умные индексы (скейп-файлы)**:
    - Встроенные индексы ускоряют выборку данных. При этом индексация автоматизирована и не требует сложной настройки.
7. **Geo-данные и аналитика**:
    - Встроенные функции для работы с геоданными (например, географические координаты, полигоны) делают ClickHouse полезным для геоаналитики.
